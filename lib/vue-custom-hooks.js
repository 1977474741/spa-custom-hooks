!function(t,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports["vue-custom-hooks"]=o():t["vue-custom-hooks"]=o()}(self,(function(){return function(){"use strict";var t={d:function(o,e){for(var n in e)t.o(e,n)&&!t.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:e[n]})},o:function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};t.r(o),t.d(o,{default:function(){return u}});class e{constructor({customhook:t,name:o,destroy:e,hit:n=!1,watchKey:s,onUpdate:i}){this.name=o,this.destroy=e,this.hit=n,this.need=!1,this.initFlag=!1,this.watchKey=s,this.onUpdate=i,this.__customhook=t}init(){this.initFlag||(this.watchKey&&this.watchAttr((t=>{this[t?"cycleStart":"cycleEnd"]()})),this.initFlag=!0)}cycleStart(){this.hit||(this.hit=!0,this.__customhook.triggerHook())}cycleEnd(){this.hit&&(this.hit=!1,this.__customhook.resetExecute(this.name))}watchAttr(t){let o=this;this.__customhook.pageInstance.$watch(this.watchKey,{immediate:!1,handler:(e,n)=>{t(o.onUpdate?o.onUpdate(e,n):e)}})}}let n={};const s=["created","beforeMount","mounted","beforeDestroy","destroyed","onLoad","attached","detached","onShow","onHide","onReady","onUnload"],i=()=>Object.keys(n);let h=s.map((t=>r(t)));class c{constructor(t,o,e){this.pageInstance=t,this.hookFun={},this.hooksStr=[],this.hook={},this.options=o,this.pageHooks=e,this.init()}init(){let t={Launch:new e({customhook:o=this,name:"onLaunch",destroy:"onUnload",hit:!0}),Created:new e({customhook:o,name:"created",destroy:"destroyed",hit:!0}),Load:new e({customhook:o,name:"onLoad",destroy:"onUnload",hit:"onLoad"==u.BASE.initHook}),Attached:new e({customhook:o,name:"attached",destroy:"detached"}),Show:new e({customhook:o,name:"onShow",destroy:"onHide"}),Mounted:new e({customhook:o,name:"mounted",destroy:"destroyed"}),Ready:new e({customhook:o,name:"onReady",destroy:"onUnload"}),...Object.keys(n).reduce(((t,s)=>{const i=n[s];return i.customhook=o,(t[s]=new e(i))&&t}),{})};var o;this.hook=t;let h={};Object.keys(this.pageHooks).filter((o=>!!i().some((t=>-1!=o.indexOf(t)&&-1==s.indexOf("on"+t)))&&(h[o]=this.splitHook(o),o=="on"+h[o].join("")&&h[o].every((o=>t[o]))))).forEach(((o,e)=>{this.hooksStr[e]={name:[],execute:!1},this.hookFun[o]=this.pageHooks[o],h[o].forEach((o=>{if(t[o]&&t[o].init)if(this.hooksStr[e].name.push(o),t[o].destroy&&t[o].name){let e=this.pageHooks;e[t[o].name].length&&e[t[o].destroy].length&&(t[o].need=!0)}else t[o].need=!0}))})),Object.keys(t).forEach((o=>t[o].need&&t[o].init()))}triggerHook(t){this.hooksStr.forEach((t=>{t.name.every((t=>this.hook[t].need&&this.checkHookHit(this.hook[t])))&&!t.execute&&(this.hookFun["on"+t.name.join("")].call(this.pageInstance,this.options),t.execute=!0)}))}resetExecute(t){t=r(t),this.hooksStr.forEach((o=>{-1!=o.name.indexOf(t)&&(o.execute=!1)}))}splitHook(t){t=t.replace("on","").split(/(?=[A-Z])/);const o=[...new Set(h.concat(i()))].sort(((t,o)=>o.length-t.length)),e=[];let n="";for(var s=0;s<t.length;s++)n+=t[s],-1!=o.indexOf(n)&&(e.push(n),n="");return e}checkHookHit(t){if(t.watchKey){let e=(o=t.__customhook.pageInstance,t.watchKey.split(".").reduce(((t,o)=>t[o]),o));return t.onUpdate?t.onUpdate(e):e}return t.hit;var o}}function r(t){return(t=t.replace("on","")).substring(0,1).toUpperCase()+t.substring(1)}const a={h5:{hooksKey:"$options.__proto__",mainHooksKey:"$options",initHook:"created",supportComponent:!0,isPage(t,o){return t._compiled&&(this.supportComponent||"page"==o||"app"==o)}},wx:{hooksKey:"$options",mainHooksKey:"$options",initHook:"created",supportComponent:!0,isPage(t,o){return this.supportComponent||"page"==o||"app"==o}}};try{uni.x}catch(t){a.wx.initHook="onLoad"}let d=a[document?"h5":"wx"];var u={init:(t,o)=>{n=o,t.mixin({...s.reduce(((t,o)=>(t[o]=function(t){if("object"!=typeof this.customHook)return;t&&(this.customHook.options=t);const e=this.customHook.hook;for(let t in e){const n=e[t];n.name==o?n.cycleStart():n.destroy==o&&n.cycleEnd()}})&&t),{}),[d.initHook](t){let o=(n=this,d["app"==this.$options.mpType?"mainHooksKey":"hooksKey"].split(".").reduce(((t,o)=>t[o]),n)),e=this.$mp&&this.$mp.mpType||o.mpType;var n;d.isPage(o,e)&&(this.customHook||(this.customHook=new c(this,t,o)))}})},BASE:d};return o}()}));